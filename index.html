<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pega Constellation Quiz</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .question { margin-bottom: 15px; font-weight: bold; }
    .option { margin: 5px 0; display: block; }
    .feedback { margin-top: 10px; font-weight: bold; }
    .correct { color: green; }
    .incorrect { color: red; }
  </style>
</head>
<body>
  <h1>Pega Constellation Quiz</h1>
  <input type="file" id="xmlFile" accept=".xml">
  <div id="quiz"></div>
  <script>
    let currentQuestion = 0;
    let allQuestions = [];

    document.getElementById('xmlFile').addEventListener('change', function (e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function (event) {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(event.target.result, 'text/xml');
        const questions = xmlDoc.getElementsByTagName('question');
        allQuestions = Array.from(questions).map(q => {
          const text = q.getElementsByTagName('text')[0].textContent;
          const options = Array.from(q.getElementsByTagName('option')).map(opt => ({
            id: opt.getAttribute('id'),
            text: opt.textContent
          }));
          const correct = q.getElementsByTagName('correct')[0].textContent.trim();
          return { text, options, correct };
        });
        currentQuestion = 0;
        showQuestion();
      };
      reader.readAsText(file);
    });

    function showQuestion() {
      if (currentQuestion >= allQuestions.length) {
        document.getElementById('quiz').innerHTML = '<h2>Quiz complete!</h2>';
        return;
      }
      const q = allQuestions[currentQuestion];
      let html = `<div class="question">Q${currentQuestion + 1}: ${q.text}</div>`;
      q.options.forEach(opt => {
        html += `<label class="option"><input type="radio" name="option" value="${opt.id}"> ${opt.id} ${opt.text}</label>`;
      });
      html += '<button onclick="checkAnswer()">Submit</button><div id="feedback" class="feedback"></div>';
      document.getElementById('quiz').innerHTML = html;
    }

    function checkAnswer() {
      const q = allQuestions[currentQuestion];
      const selected = document.querySelector('input[name="option"]:checked');
      const feedback = document.getElementById('feedback');
      if (!selected) {
        feedback.textContent = 'Please select an option.';
        feedback.className = 'feedback';
        return;
      }
      if (selected.value === q.correct) {
        feedback.textContent = 'Correct!';
        feedback.className = 'feedback correct';
      } else {
        feedback.textContent = `Incorrect. Correct answer is ${q.correct}`;
        feedback.className = 'feedback incorrect';
      }
      setTimeout(() => {
        currentQuestion++;
        showQuestion();
      }, 1500);
    }
  </script>
</body>
</html>
